## 자동차 대여 기록 별 대여 금액 구하기
- 자동차 정보를 담은 테이블 (CAR_RENTAL_COMPANY_CAR)
- 자동차 대여 정보를 담은 테이블 (CAR_RENTAL_COMPANY_RENTAL_HISTORY)
- 자동차 대여 기간별 할인율을 담은 테이블 (CAR_RENTAL_COMPANY_DISCOUNT_PLAN)
- 이 세가지 테이블을 활용하여 '트럭' 자동차에 대한 대여기록 중에 대여기간별로 할인을 적용한 총 대여 금액을 계산해서 출력

```sql
SELECT A.HISTORY_ID,
CEIL(CASE WHEN DATEDIFF(A.END_DATE, A.START_DATE) >= 89 
THEN (DATEDIFF(A.END_DATE, A.START_DATE)+1)*B.DAILY_FEE * (1-(SELECT DISCOUNT_RATE/100 FROM CAR_RENTAL_COMPANY_DISCOUNT_PLAN WHERE CAR_TYPE = '트럭' AND DURATION_TYPE = '90일 이상'))
WHEN DATEDIFF(A.END_DATE, A.START_DATE) >= 29 THEN (DATEDIFF(A.END_DATE, A.START_DATE)+1)*B.DAILY_FEE*(1-(SELECT DISCOUNT_RATE/100 FROM CAR_RENTAL_COMPANY_DISCOUNT_PLAN WHERE CAR_TYPE = '트럭' AND DURATION_TYPE = '30일 이상'))
WHEN DATEDIFF(A.END_DATE, A.START_DATE) >= 6 THEN (DATEDIFF(A.END_DATE, A.START_DATE)+1)*B.DAILY_FEE*(1-(SELECT DISCOUNT_RATE/100 FROM CAR_RENTAL_COMPANY_DISCOUNT_PLAN WHERE CAR_TYPE = '트럭' AND DURATION_TYPE = '7일 이상'))
ELSE (DATEDIFF(A.END_DATE, A.START_DATE)+1)*B.DAILY_FEE
END) FEE
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY AS A, CAR_RENTAL_COMPANY_CAR AS B
WHERE A.CAR_ID = B.CAR_ID
AND B.CAR_TYPE = '트럭'
ORDER BY FEE DESC, HISTORY_ID DESC
```
## 해설
- 할인율을 직접 CASE WHEN 문을 통해 불러와서 할인율을 반영해 계산
